# アーキテクチャのコツ
- webアプリケーションのベース
    + ec2
        - 再起動するとIPアドレス変わる
    + elastic IP Address
        - 静的にIPアドレスを固定する
- 設計のコツ
    + 単一障害点を作らない
- リージョン内のコツ
    + DC(データセンター)の冗長化
    + AZは複数のDCから構成される
    + DC間は低遅延メッシュネットワークで繋がっている

- 中長期的な拡張性
    + スケールアップ
        - サーバー一台あたりのリソースを強化
    + スケールアウト
        - 台数ふやす
- ALB
    + 複数AZで動作
    + 自動でスケーリングする
- リージョン障害どうすんねん
    + AZが死ぬってどういう定義だ

- ステートレスなアプリケーションであることが大切
    + 長時間存在するすべてのデータはステートフルなバックエンドサービスに格納しなければならない

## ハンズオンメモ
- VPC
    + 独自の仮想ネットワークを組める
    + 事前にセキュリティグループを作成する(ファイアウォール)
- サブネット
    + パブリックサブネット
        - インターネットから中のリソースにアクセス可能
    + プライベートサブネット
        - インターネット側から中のリソースにアクセスできない
        - サブネットの中からインターネット側にアクセスはできる

## 気になる単語
- IPv4 CIDRブロック
- ICMP


## CloudFront
- CDN
 + 地理的に分散したサーバー群からコンテンツをキャッシュしたり代理配信するサービス
 + キャッシングだけじゃない！

## ElastiCache
- インメモリーなキャッシュを管理してくれる
　+ redis使う時とかね
　+ ec2で自前で動かすより楽だよ

## クイズ

### 問題1
- 問題
　- 下記の要件の場合にロードバランサー、コンピュート、DBに適切なAWSサービスを選択せよ
    + 利用者数: 数万人
    + アプリケーション: Ruby On rails
    + データベース: Dockerを利用して開発中, RDBであるMySQLを採用
- 回答
    - ロードバランサー
        + ALB
    - コンピュート
        + ECS
        + Lambda使うならバッチ処理くらいかな、、
        + EC2はなんか可用性低いイメージ
    - DB
        + RDS
        + 一個しか選べないDBでRedis使う人いるんか？

- 解説
    - ELB
        - Elastic Load Balancer
    - NLB
        - Network Load Balancer
        - 高いパフォーマスとアプリ用の静的IP
        - IPでさばけるNLB
        - あんま使わん



### 問題2
- 問題
あとでスクショ

- 回答
    - ALB -> EC2(ECS) -> S3
    - 数万人のユーザーだしアクセスをさばくLBは必要でしょ
    - でもCDNないのもなあ、、
    - ALB -> CDN -> S3があればそれ選んだ
- 解説
    - CloudFront
        - オリジンサーバーの負荷を軽減
        - LBなくてもリクエスト捌けるぽい
    - EC2(ECS)
        - 結局運用大変
        


### 問題3
- 問題
後でスクショ
- 回答
    - S3
    - 
- 解説
    - NFS
    - EFS
        + マネージドなNetworkFileSystem


### 問題4
- 問題
- 回答
- 解説

### 問題5
- 問題
- 回答
- 解説
